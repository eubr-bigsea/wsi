<html>
  <head>
    <title>WSI DB Documentation</title>
    <style>
     .api-method-description {
         max-width: 700px;
     }
     .api-method-description h4 {
         padding-top: 15px;
         margin-bottom: 5px;
     }
     .api-method-description table {
         padding-left: 10px;
     }
     .api-method-description td {
         border: 1px solid black;
         padding: 5px;
     }
     .api-example code {
         display: block;
         padding: 20px 30px;
     }
    </style>
  </head>
  <body>
    <div id="APIdocumentation">
      <h3>API DB Documentation</h3>
      The Web Service is implemented as a
      <em><a href="https://en.wikipedia.org/wiki/Representational_state_transfer">
        RESTFul
      </a></em> API.

      <p>
      All resources services are located in the following path:
        <em>"WSDB/"</em>
      </p>

      <div class="api-method-description">
        <h4>Register New App-Session-ID</h4>
        <table>
          <tr>
            <td>Resource Path:</td>
            <td>/register/newapp/</td>
          </tr>
          <tr>
            <td>HTTP Method:</td>
            <td>POST</td>
          </tr>
          <tr>
            <td>POST Body:</td>
            <td>APP_SESSION_ID APPLICATION_ID DATASET_SIZE SUBMISSION_TIME</td>
          </tr>
          <tr>
            <td>Description:</td>
            <td>
              It submits a new session application and registers it in the database.<br>
              The submission time has to be in <em><a href="https://en.wikipedia.org/wiki/Unix_time">Unix Time</a></em> format.
            </td>
          </tr>
          <tr>
            <td>Returns:</td>
            <td>A confirmation or error message.</td>
          </tr>
        </table>
      </div>

      <div class="api-method-description">
        <h4>Register Ending Application</h4>
        <table>
          <tr>
            <td>Resource Path:</td>
            <td>/register/endapp/</td>
          </tr>
          <tr>
            <td>HTTP Method:</td>
            <td>POST</td>
          </tr>
          <tr>
            <td>POST Body:</td>
            <td>APP_SESSION_ID ENDING_TIME</td>
          </tr>
          <tr>
            <td>Description:</td>
            <td>
              It registers an application session which is ended.
              The application session is identified by its ID (the entry must to exist in the database in order
              to be updated).<br>
              The ending time has to be in <em><a href="https://en.wikipedia.org/wiki/Unix_time">Unix Time</a></em> format.
            </td>
          </tr>
          <tr>
            <td>Returns:</td>
            <td>A confirmation or error message.</td>
          </tr>
        </table>
      </div>

      <div class="api-example">
        <h3>API usage example</h3>
        <p>
          
          Get a new session:<br>
          
          <code>
curl http://localhost:8080/WSI/session/new
          </code>
        </p>

        <p>
          It returns a unique session identifier, for example:<br>
          
          <code>
88421905-bdff-4ae3-b325-90b74e9e4974
          </code>
        </p>

        <p>
          Now the number of calls and available cores should be set. For example with the same session ID,
          we set the number of calls and cores to 2:<br>
          <code>
curl -X POST "http://localhost:8080/WSI/session/setcalls?SID=88421905-bdff-4ae3-b325-90b74e9e4974&ncalls=2&ncores=2"
          </code>
        </p>

        <p>
          The server should answer with a positive message:<br>
          <code>
OK. Numbers have been set
          </code>
        </p>

        <p>
          Since we have just set 2 calls, the server will expect exactly 2 calls for set parameters.
        </p>

        <p>
          The first setting may be something like:<br>
          <code>
curl -X POST -H "Content-Type: text/plain" -d 'APP-SESSION-ID1 3.14 3.14' "http://localhost:8080/WSI/session/setparams?SID=88421905-bdff-4ae3-b325-90b74e9e4974"
          </code>
        </p>

        <p>
          If there is no error, the server should answer:<br>
          <code>
OK. AppParams have been set. 1 remain to set
          </code>
        </p>

        <p>
          The last call, instead, will return the optimizer results.
        </p>
      </div>
    </div>
  </body>
</html>
